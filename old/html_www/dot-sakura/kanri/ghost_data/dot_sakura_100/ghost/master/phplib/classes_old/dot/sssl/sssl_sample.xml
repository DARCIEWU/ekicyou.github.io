■SakuraScript 2.0
  http://jn.swee.to/s3c/sakurascript_2.html

=======================================================================
■タグ解説
=======================================================================

-----------------------------------------------------------------------
・SSSL：ルートタグ
  ＃全てはここから
  ＜含まれるタグ＞
    1.  以下のタグを１つ以上、任意の数含む
          SEQ
          PAR
          TEXT
          SECTION
          REFTEXT
          REFSECTION
          REF
  ＜制限事項＞
    1.  id属性の指定を省略できるのは一つだけ（デフォルトタグと判定）
    2.  このタグの中に含まれる全てのタグのidは重複しないこと
    3.  id属性が有効なのは、ssslタグ直下のタグのみ。
        孫以降のタグにidが指定されても無視される
  ＜挙動＞
    1.  全てのタグを読み込み、idリストを作成する
    2.  デフォルトタグ、あるいは呼び出し時にidが指定された場合は
        そのidのタグを評価し、戻り値とする


-----------------------------------------------------------------------
・SEQ：順次再生（ブロック要素）
  ＃タグに含まれる要素を、上から順に再生する
  ＜含まれるタグ＞
    1.  下記要素を一つ指定できる。指定された場合、他の要素は指定できない
          RANDOM
    2-1.記要素を任意数含むことが出来る
          SEQ
          PAR
          SECTION
          REFSECTION
  ＜挙動＞
    1.  先頭から順次タグを評価し、それらの戻り値を結合したものを
        このタグの戻り値とする


-----------------------------------------------------------------------
・PAR：同時再生（ブロック要素）
  ＃タグに含まれる要素を、全て同時に再生する
  ＜含まれるタグ＞
    1.  下記要素を一つ指定できる。指定された場合、他の要素は指定できない
          RANDOM
    2-1.下記要素を任意数含むことが出来る
          SEQ
          PAR
          SECTION
          REFSECTION
  ＜挙動＞
    1.  先頭から順次タグを評価し、それらの戻り値を全て同時再生と扱い、
        合成したものをこのタグの戻り値とする


-----------------------------------------------------------------------
・SECTION：会話ブロック（ブロック要素）
  ＃会話ブロック（同じ表情、同じキャラクター）毎に出現する
  ＜含まれるタグ＞
    1.  下記要素を一つ指定できる。指定された場合、他の要素は指定できない
          RANDOM
    2-1.最初に下記要素を任意数含むことが出来る
          CHAR
    2-2.下記要素を任意数含むことが出来る
          TEXT
          REFTEXT
  ＜挙動＞
    1.  CHARタグを評価する
    2.  TEXT|REFTEXTを順次評価する。
    3.  最後にCHARタグを合成し、このタグの戻り値とする


-----------------------------------------------------------------------
・TEXT：テキスト（テキスト要素）
　＃会話の最小単位
  ＜含まれるタグ＞
    1.  下記要素を一つ指定できる。指定された場合、他の要素は指定できない
          RANDOM
    2-1.下記要素を任意数含むことが出来る
          #PCDATA
          TEXT
          REFTEXT
  ＜挙動＞
    1.  #PCDATA|TEXT|REFTEXTを順次評価し、このタグの戻り値とする。


-----------------------------------------------------------------------
・REFSECTION：参照会話ブロック（ブロック要素）
　＃内部、又は外部SSSLに記述されている「ブロック要素」を参照する
  ＜属性＞
    src   参照される、ブロック要素を返すSSSLテキスト
  ＜含まれるタグ＞
    無し
  ＜制限事項＞
    1.  再帰呼び出しは常にNG。但し同じSSSLでもIDが違う場合は認められる
    2.  呼び出されるブロックは「ブロック要素」（SEQ|PAR|SECTION）を
        返さなくてはならない。
  ＜挙動＞
    1.  srcで指定されたSSSLを読み込む
    2.  SSSLの戻り値を返す


-----------------------------------------------------------------------
・REFTEXT：参照テキスト（テキスト要素）
　＃内部、又は外部SSSLに記述されている「テキスト要素」を参照する
  ＜属性＞
    src   参照される、テキスト要素を返すSSSLテキスト
  ＜含まれるタグ＞
    無し
  ＜制限事項＞
    1.  再帰呼び出しは常にNG。但し同じSSSLでもIDが違う場合は認められる
    2.  呼び出されるブロックは「ブロック要素」（SEQ|PAR|SECTION）を
        返さなくてはならない。
  ＜挙動＞
    1.  srcで指定されたSSSLを読み込む
    2.  呼び出したSSSLの戻り値を返す







・REF：リファレンスジャンプ
　＃タグに含まれるURLにジャンプする
  ＜含まれるタグ＞
　１．下記要素を一つ含むことが出来る
　　#PCDATA
　　RANDOM





=======================================================================
■属性解説
=======================================================================

-----------------------------------------------------------------------
・id
    参照で呼び出す時に利用されるキーワード


-----------------------------------------------------------------------
・src
    参照される、テキスト要素を返すSSSLテキスト
    リモートファイル指定可能
    名称が"～#id"で記述される場合、
    呼び出されたSSSLの該当idブロックを呼び出す

-----------------------------------------------------------------------
・begin
    再生開始までの待ち時間。




■DTD







■ あいさつ.sssl
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sssl PUBLIC "-//NANIKA_TO//DTD SSSL 1.0//EN" "http://www.nanika.to/2004/sssl10.dtd">
<?xml-stylesheet type="text/xsl" href="http://www.nanika.to/2004/sssl10.xsl"?>
<sssl xmlns="http://www.nanika.to/2004/sssl" xml:lang="ja" lang="ja">
<head>
  <meta http-equiv="content-type" content="text/xml; charset=UTF-8" />
  <meta http-equiv="x-sssl-content-type" content="talk" />
  <meta http-equiv="x-sssl-ghost-name" content="．さくら,うにゅう" />
  <meta http-equiv="x-sssl-ghost-id" content="dot_sakura100" />
  <title>あいさつ<title>
</head>
<body>
  <seq>
    <section>
      <character object="0" surface="0" />
      <text>こんにちは～、</text>
      <reftext href="人名" begin="0.2s" id="name" />
      <text>さん。</text>
    </section>
    <refsection href="あいさつの返事" begin="0.4s">
      <param name="name" srcid="name" />
    </linksection>
  <seq>
</body>
</sssl>


■ あいさつの返事.sssl
<sssl>
<head>
  <meta http-equiv="x-sssl-content-type" content="section" />
  <title>あいさつの返事<title>
</head>
<body>
  <seq>
    <section>
      <character object="1" surface="11" />
      <text srcid="name" begin="0.2s" />
      <text>です。</text>
      <text begin="0.4s">よろしく。</text>
    </session>
    <session begin="0.4s">
      <character object="0" surface="4" />
      <text>うにゅうには言ってないよ。</text>
    </section>
  <seq>
</body>
</sssl>


■ 人名.sssl
<sssl>
<head>
  <meta http-equiv="x-sssl-content-type" content="text" />
  <title>人名<title>
</head>
<body>
  <reftext>
    <random>
      <option>人名/0001</option>
      <option>人名/0002</option>
      <option>人名/0003</option>
    </random>
<!-- あるいは
    <random min="1" max="3" ref="人名/%04d" />
-->
  </reftext>
</body>
</sssl>


■ 人名/0001.sssl(1)
<sssl>
<head>
  <meta http-equiv="x-sssl-content-type" content="text" />
  <title>0001<title>
</head>
<body>小泉</body>
</sssl>


■ 人名/0002.sssl(1)
<sssl>
<head>
  <meta http-equiv="x-sssl-content-type" content="text" />
  <title>0002<title>
</head>
<body>ブッシュ</body>
</sssl>


■ 人名/0003.sssl(1)
<sssl>
<head>
  <meta http-equiv="x-sssl-content-type" content="text" />
  <title>0003<title>
</head>
<body>福田</body>
</sssl>

